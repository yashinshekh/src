import scrapy
import os
import requests
import dirtyjson
import json
import csv

cats = {
    "drone":b'{"requests":[{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Drones%20%26%20Robotics%22%20OR%20%22category_hierarchy%22%3A%22Electric%20scooters%2C%20skateboards%20%26%20bikes%22%20OR%20%22category_hierarchy%22%3A%22In-Car%20Gear%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Availability%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22Drones%20%26%20Robotics%22%20OR%20%22category_hierarchy%22%3A%22Electric%20scooters%2C%20skateboards%20%26%20bikes%22%20OR%20%22category_hierarchy%22%3A%22In-Car%20Gear%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Drones%20%26%20Robotics%22%20OR%20%22category_hierarchy%22%3A%22Electric%20scooters%2C%20skateboards%20%26%20bikes%22%20OR%20%22category_hierarchy%22%3A%22In-Car%20Gear%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Availability%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22Drones%20%26%20Robotics%22%20OR%20%22category_hierarchy%22%3A%22Electric%20scooters%2C%20skateboards%20%26%20bikes%22%20OR%20%22category_hierarchy%22%3A%22In-Car%20Gear%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=sku%3A%20588627%20OR%20skus%3A%20588627%20OR%20sku%3A%20588628%20OR%20skus%3A%20588628%20OR%20sku%3A%20530337%20OR%20skus%3A%20530337%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=3&facets=%5B%22facets.Category%22%2C%22facets.Availability%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=sku%3A%20588627%20OR%20skus%3A%20588627%20OR%20sku%3A%20588628%20OR%20skus%3A%20588628%20OR%20sku%3A%20530337%20OR%20skus%3A%20530337%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22keywords%22%3A%22Drones%2C%20E-scooters%20%26amp%3B%20Car%20Gear%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Availability%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22keywords%22%3A%22Drones%2C%20E-scooters%20%26amp%3B%20Car%20Gear%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"}]}',
    "fitness_activity":b'{"requests":[{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Activity%20trackers%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%2C%22facets.Colour%22%5D&tagFilters="},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Activity%20trackers%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%2C%22facets.Colour%22%5D&tagFilters="},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22keywords%22%3A%22Activity%20trackers%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%2C%22facets.Colour%22%5D&tagFilters="}]}',
    "fitness_bike_computer" : b'{"requests":[{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Bike%20computers%20%26%20accessories%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%5D&tagFilters="},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Bike%20computers%20%26%20accessories%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%5D&tagFilters="},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22keywords%22%3A%22Bike%20computers%20%26amp%3B%20accessories%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%5D&tagFilters="}]}',
    "fitness_heart_rate_monitor" : b'{"requests":[{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Heart%20rate%20monitors%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%5D&tagFilters="},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Heart%20rate%20monitors%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%5D&tagFilters="},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22keywords%22%3A%22Heart%20rate%20monitors%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%5D&tagFilters="}]}',
    "fitness_smart_watch" : b'{"requests":[{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Smart%20watches%22%20OR%20%22facets.Smart%20Watch%22%3A%20%22True%22%20OR%20%22category_hierarchy%22%3A%22Sports%20watches%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Brand%22%2C%22facets.Fitness%20device%20type%22%2C%22facets.Face%20size%20(mm)%22%2C%22facets.Network%20compatibility%22%2C%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22Smart%20watches%22%20OR%20%22facets.Smart%20Watch%22%3A%20%22True%22%20OR%20%22category_hierarchy%22%3A%22Sports%20watches%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Smart%20watches%22%20OR%20%22facets.Smart%20Watch%22%3A%20%22True%22%20OR%20%22category_hierarchy%22%3A%22Sports%20watches%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Brand%22%2C%22facets.Fitness%20device%20type%22%2C%22facets.Face%20size%20(mm)%22%2C%22facets.Network%20compatibility%22%2C%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22Smart%20watches%22%20OR%20%22facets.Smart%20Watch%22%3A%20%22True%22%20OR%20%22category_hierarchy%22%3A%22Sports%20watches%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22keywords%22%3A%22Smart%20watches%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Brand%22%2C%22facets.Fitness%20device%20type%22%2C%22facets.Face%20size%20(mm)%22%2C%22facets.Network%20compatibility%22%2C%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22keywords%22%3A%22Smart%20watches%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"}]}',
    "fitness_sport_watch" : b'{"requests":[{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Sports%20watches%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Network%20compatibility%22%2C%22facets.Face%20size%20(mm)%22%2C%22facets.Colour%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22Sports%20watches%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Sports%20watches%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Network%20compatibility%22%2C%22facets.Face%20size%20(mm)%22%2C%22facets.Colour%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22Sports%20watches%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22keywords%22%3A%22Sports%20watches%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Network%20compatibility%22%2C%22facets.Face%20size%20(mm)%22%2C%22facets.Colour%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22keywords%22%3A%22Sports%20watches%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"}]}',
    "headphone_speakers" : b'{"requests":[{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Headphones%2C%20Speakers%20%26%20Audio%22%20%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22Headphones%2C%20Speakers%20%26%20Audio%22%20%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Headphones%2C%20Speakers%20%26%20Audio%22%20%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22Headphones%2C%20Speakers%20%26%20Audio%22%20%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=sku%3A%20535587%20OR%20skus%3A%20535587%20OR%20sku%3A%20536142%20OR%20skus%3A%20536142%20OR%20sku%3A%20536143%20OR%20skus%3A%20536143%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=3&facets=%5B%22facets.Category%22%2C%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=sku%3A%20535587%20OR%20skus%3A%20535587%20OR%20sku%3A%20536142%20OR%20skus%3A%20536142%20OR%20sku%3A%20536143%20OR%20skus%3A%20536143%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22keywords%22%3A%22Headphones%2C%20Speakers%20%26amp%3B%20Audio%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22keywords%22%3A%22Headphones%2C%20Speakers%20%26amp%3B%20Audio%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"}]}',
    "health_and_fitness" : b'{"requests":[{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Health%2C%20Fitness%20%26%20Wearables%22%20OR%20%22category_hierarchy%22%3A%22Health%20%26%20grooming%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Brand%22%2C%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22Health%2C%20Fitness%20%26%20Wearables%22%20OR%20%22category_hierarchy%22%3A%22Health%20%26%20grooming%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Health%2C%20Fitness%20%26%20Wearables%22%20OR%20%22category_hierarchy%22%3A%22Health%20%26%20grooming%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Brand%22%2C%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22Health%2C%20Fitness%20%26%20Wearables%22%20OR%20%22category_hierarchy%22%3A%22Health%20%26%20grooming%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=sku%3A%20531805%20OR%20skus%3A%20531805%20OR%20sku%3A%20535535%20OR%20skus%3A%20535535%20OR%20sku%3A%20535524%20OR%20skus%3A%20535524%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=3&facets=%5B%22facets.Category%22%2C%22facets.Brand%22%2C%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=sku%3A%20531805%20OR%20skus%3A%20531805%20OR%20sku%3A%20535535%20OR%20skus%3A%20535535%20OR%20sku%3A%20535524%20OR%20skus%3A%20535524%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22keywords%22%3A%22Fitness%2C%20Health%20%26amp%3B%20Wellbeing%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Brand%22%2C%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22keywords%22%3A%22Fitness%2C%20Health%20%26amp%3B%20Wellbeing%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"}]}',
    "home_appliances" : b'{"requests":[{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Home%20Appliances%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Availability%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22Home%20Appliances%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22Home%20Appliances%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Availability%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22Home%20Appliances%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=sku%3A%20479357%20OR%20skus%3A%20479357%20OR%20sku%3A%20585991%20OR%20skus%3A%20585991%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=3&facets=%5B%22facets.Category%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Availability%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=sku%3A%20479357%20OR%20skus%3A%20479357%20OR%20sku%3A%20585991%20OR%20skus%3A%20585991%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22keywords%22%3A%22Home%20Appliances%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Availability%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22keywords%22%3A%22Home%20Appliances%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"}]}',
    "kids_activity_tracker" : b'{"requests":[{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22facets.Activity%20tracker%20for%20kids%22%3A%20%22true%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%2C%22facets.Colour%22%5D&tagFilters="},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22facets.Activity%20tracker%20for%20kids%22%3A%20%22true%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%2C%22facets.Colour%22%5D&tagFilters="},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22keywords%22%3A%22Kids%20trackers%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Availability%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Brand%22%2C%22facets.Colour%22%5D&tagFilters="}]}',
    "tvs" : b'{"requests":[{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22TVs%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Screen%20Size%20(Inches)%22%2C%22facets.TV%20series%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Availability%22%2C%22facets.Screen%20type%22%2C%22facets.Backlighting%20type%22%2C%22facets.Screen%20Resolution%22%2C%22facets.HDR%20(High%20Dynamic%20Range)%22%2C%22facets.HDMI%202.1%20inputs%22%2C%22facets.Variable%20Refresh%20Rate%20(VRR)%22%2C%22facets.Smart%20OS%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families_published_at_desc","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22TVs%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22category_hierarchy%22%3A%22TVs%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Screen%20Size%20(Inches)%22%2C%22facets.TV%20series%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Availability%22%2C%22facets.Screen%20type%22%2C%22facets.Backlighting%20type%22%2C%22facets.Screen%20Resolution%22%2C%22facets.HDR%20(High%20Dynamic%20Range)%22%2C%22facets.HDMI%202.1%20inputs%22%2C%22facets.Variable%20Refresh%20Rate%20(VRR)%22%2C%22facets.Smart%20OS%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22category_hierarchy%22%3A%22TVs%22%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)%20AND%20onPromotion%3Atrue%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=sku%3A%20562036%20OR%20skus%3A%20562036%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=3&facets=%5B%22facets.Category%22%2C%22facets.Screen%20Size%20(Inches)%22%2C%22facets.TV%20series%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Availability%22%2C%22facets.Screen%20type%22%2C%22facets.Backlighting%20type%22%2C%22facets.Screen%20Resolution%22%2C%22facets.HDR%20(High%20Dynamic%20Range)%22%2C%22facets.HDMI%202.1%20inputs%22%2C%22facets.Variable%20Refresh%20Rate%20(VRR)%22%2C%22facets.Smart%20OS%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_products_families","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=sku%3A%20562036%20OR%20skus%3A%20562036%20AND%20(price%20%3E%200%20AND%20product_published%20%3D%201%20AND%20availability.displayProduct%20%3D%201)&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=true&filters=%22keywords%22%3A%22TVs%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1024&facets=%5B%22facets.Category%22%2C%22facets.Screen%20Size%20(Inches)%22%2C%22facets.TV%20series%22%2C%22facets.Brand%22%2C%22facets.Price%22%2C%22onPromotion%22%2C%22facets.Availability%22%2C%22facets.Screen%20type%22%2C%22facets.Backlighting%20type%22%2C%22facets.Screen%20Resolution%22%2C%22facets.HDR%20(High%20Dynamic%20Range)%22%2C%22facets.HDMI%202.1%20inputs%22%2C%22facets.Variable%20Refresh%20Rate%20(VRR)%22%2C%22facets.Smart%20OS%22%5D&tagFilters=&numericFilters=%5B%22facets.Price%3E%3D490%22%5D"},{"indexName":"shopify_search_content","params":"highlightPreTag=%3Cais-highlight-0000000000%3E&highlightPostTag=%3C%2Fais-highlight-0000000000%3E&page=0&clickAnalytics=false&filters=%22keywords%22%3A%22TVs%22&query=&distinct=true&maxValuesPerFacet=100&hitsPerPage=1&attributesToRetrieve=%5B%5D&attributesToHighlight=%5B%5D&attributesToSnippet=%5B%5D&tagFilters=&analytics=false&facets=facets.Price"}]}'
}

datas = []

for k,v in cats.items():
    req = requests.post(url='https://vtvkm5urpx-dsn.algolia.net/1/indexes/*/queries?x-algolia-agent=Algolia%20for%20JavaScript%20(4.12.1)%3B%20Browser%3B%20JS%20Helper%20(3.7.0)%3B%20react%20(16.14.0)%3B%20react-instantsearch%20(6.22.0)',
                        headers={'Host': 'vtvkm5urpx-dsn.algolia.net', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0', 'Accept': '*/*', 'Accept-Language': 'en-US,en;q=0.5', 'Accept-Encoding': 'gzip, deflate, br', 'x-algolia-api-key': '1d989f0839a992bbece9099e1b091f07', 'x-algolia-application-id': 'VTVKM5URPX', 'content-type': 'application/x-www-form-urlencoded', 'Content-Length': '5761', 'Origin': 'https://www.jbhifi.com.au', 'Connection': 'keep-alive', 'Referer': 'https://www.jbhifi.com.au/', 'Sec-Fetch-Dest': 'empty', 'Sec-Fetch-Mode': 'cors', 'Sec-Fetch-Site': 'cross-site'},
                        data=v,
                        )

    jsondata = json.loads(json.dumps(dirtyjson.loads(req.text)))

    for data in jsondata['results'][0]['hits']:
        handle = '/products/'+data['handle']
        price = data['price']
        category = str(k).replace('_',' ')

        datas.append([category,handle,price])


headers = {
    "Request Headers (727 B)": {
        "headers": [
            {
                "name": "Accept",
                "value": "*/*"
            },
            {
                "name": "Accept-Encoding",
                "value": "gzip, deflate, br"
            },
            {
                "name": "Accept-Language",
                "value": "en-US,en;q=0.5"
            },
            {
                "name": "Connection",
                "value": "keep-alive"
            },
            {
                "name": "Content-Length",
                "value": "1884"
            },
            {
                "name": "content-type",
                "value": "application/x-www-form-urlencoded"
            },
            {
                "name": "Host",
                "value": "vtvkm5urpx-dsn.algolia.net"
            },
            {
                "name": "Origin",
                "value": "https://www.jbhifi.com.au"
            },
            {
                "name": "Referer",
                "value": "https://www.jbhifi.com.au/"
            },
            {
                "name": "Sec-Fetch-Dest",
                "value": "empty"
            },
            {
                "name": "Sec-Fetch-Mode",
                "value": "cors"
            },
            {
                "name": "Sec-Fetch-Site",
                "value": "cross-site"
            },
            {
                "name": "User-Agent",
                "value": "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:92.0) Gecko/20100101 Firefox/92.0"
            },
            {
                "name": "x-algolia-api-key",
                "value": "1d989f0839a992bbece9099e1b091f07"
            },
            {
                "name": "x-algolia-application-id",
                "value": "VTVKM5URPX"
            }
        ]
    }
}


base_headers = {}

import datetime

for key in headers.keys():
    for data in headers[key]['headers']:
        base_headers[data['name']] = data['value']



# https://www.jbhifi.com.au/collections/drones-robotics?page=1&range%5Bfacets.Price%5D%5Bmin%5D=490&hitsPerPage=800

class JbhifiSpider(scrapy.Spider):
    name = 'jbhifi'
    allowed_domains = ['jbhifi.com']
    start_urls = ['http://jbhifi.com/']

    custom_settings = {
        "DOWNLOAD_DELAY":0.5,
        "CONCURRENT_REQUESTS":100
    }

    alreadyscrapped = []

    if 'jbhifi.csv' not in os.listdir(os.getcwd()):
        with open("jbhifi.csv","a",newline="",encoding="utf-8") as f:
            writer = csv.writer(f)
            writer.writerow(['date','category','title','model','sku','url','price','Wishlist/Cart','image_1','image_2','image_3','image_4','image_5','image_6','image_7','image_8','image_9','image_10'])
            # writer.writerow(['date','category','title','model','sku','url','price','image_1','image_2','image_3','image_4','image_5','image_6','image_7','image_8','image_9','image_10'])


    with open("jbhifi.csv","r",encoding="utf-8") as r:
        reader = csv.reader(r)
        for line in reader:
            alreadyscrapped.append(line[5])


    def start_requests(self):
        # links = scrapy.Selector(text=open("jbhifi.html","r").read()).xpath('.//*[@class="ais-hits--item ais-hits--item"]/div/a/@href').extract()
        #
        # for link in links:
        #     if 'https://www.jbhifi.com.au'+str(link) not in self.alreadyscrapped:
        #         yield scrapy.Request('https://www.jbhifi.com.au'+str(link),callback=self.parse)
        #     else:
        #         print("Exists ...")


        # with open("link.csv","r") as r:
        #     reader = csv.reader(r)
        #     for line in reader:
        #         try:
        #             if 'https://www.jbhifi.com.au'+str(line[1]) not in self.alreadyscrapped and int(line[2]) > 490:
        #                 yield scrapy.Request('https://www.jbhifi.com.au'+str(line[1]),callback=self.parse,dont_filter=True,meta={
        #                     'cat':line[0],
        #                     'price':line[2]
        #                 })
        #             else:
        #                 print("Exists ...")
        #         except:
        #             pass

        for data in datas:
            try:
                if 'https://www.jbhifi.com.au'+str(data[1]) not in self.alreadyscrapped and int(data[2]) > 490:
                    yield scrapy.Request('https://www.jbhifi.com.au'+str(data[1]),callback=self.parse,dont_filter=True,meta={
                        'cat':data[0],
                        'price':data[2]
                    })
                else:
                    print("Exists ...")

            except:
                pass

    def parse(self, response,*args):

        date = datetime.datetime.today().strftime('%m/%d/%y')
        # category = ' > '.join([i.strip() for i in response.xpath('.//*[@class="breadcrumbnav"]/li/a/text() | .//*[@class="breadcrumbnav"]/li/span/text() | .//*[@class="breadcrumbnav breadcrumbnav--overflow-4"]/li/a/text() | .//*[@class="breadcrumbnav breadcrumbnav--overflow-4"]/li/span/text() | .//*[@class="breadcrumbnav breadcrumbnav--overflow-5"]/li/a/text() | .//*[@class="breadcrumbnav breadcrumbnav--overflow-5"]/li/span/text()').extract() if i.strip()])
        category = response.meta.get('cat')

        title = response.xpath('.//*[@property="og:title"]/@content').extract_first()
        try:
            model = response.text[response.text.index('"Model":"')+9:][:response.text[response.text.index('"Model":"')+9:].index('"')]
        except:
            model = ''
        try:
            sku = response.text[response.text.index('"sku":"')+7:][:response.text[response.text.index('"sku":"')+7:].index('"')]
        except:
            sku = ''
        url = response.url
        # price = response.xpath('.//*[@class="price"]/text() | .//*[@class="sale"]/text()').extract_first()
        price = response.meta.get('price')

        # images = ['https:'+str(i).replace('_100x100','') for i in response.xpath('.//*[@class="thumbnail--image-wrapper"]/img/@data-src').extract()]
        images = response.xpath('.//*[@property="og:image"]/@content').extract()

        addcard_addwishlist = 'Add to wish list' if "No longer available" in str(response.xpath('.//*[@id="MainContent"]/script[contains(.,"id")]').extract_first()) else 'Add to cart'

        # if response.meta.get('cat')+'.csv' not in os.listdir(os.getcwd()):
        #     with open(response.meta.get('cat')+".csv","a") as f:
        #         writer = csv.writer(f)
        #         writer.writerow(['date','category','title','model','sku','url','price','image_1','image_2','image_3','image_4','image_5','image_6','image_7','image_8','image_9','image_10'])
        #

            # with open(response.meta.get('cat')+'.csv',"a") as f:
        with open('jbhifi.csv',"a",newline="",encoding="utf-8") as f:
            writer = csv.writer(f)
            writer.writerow([date,category,title,model,sku,url,price,addcard_addwishlist]+images)
            print([date,category,title,model,sku,url,price,addcard_addwishlist]+images)
            # print([date,category,title,model,sku,url,price]+images)

